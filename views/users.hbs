{{!-- This is the administration page for references --}} 
{{#> layout title="Users" nav=1 useActive=1}} 

{{#*inline "header-block"}}
    <style>
        .table td.fit, 
        .table th.fit {
            white-space: nowrap;
            width: 1%;
        }
    </style>
{{/inline}}

{{#*inline "scripts-block"}}
    <script src="usertools.js"></script>
{{/inline}}

{{#*inline "search-area"}}
{{#if message}}
    <div class="alert alert-success">{{message}}</div>
{{/if}}
<form class="form inline">
    <div class="form-group">
        <label for="email">Invite address:</label>
        <input type="email" class="form-control" id="email">
    </div>
    <button type="submit" href='/users/invite' class="btn btn-primary">
        <span class="glyphicon glyphicon-gift"></span> Invite New Editor</a>
</form>

{{/inline}} 

{{#*inline "results-area"}} {{! Results header }}
<div id="mainDisplay" role="main">

    {{! Results group }}
    <div class="table-responsive">

        <table class="table table-responsive table-hover" style="table-layout: auto">
            <thead>
                <tr>
                    <th>Email</th>
                    <th>Display Name</th>
                    <th class="fit" colspan="2">Validated</th>
                    <th class="fit" colspan="3">Permissions</th>
                    <th class="fit">Delete</th>
                </tr>
            </thead>
            <tbody data-bind="foreach: users">
                <tr>
                    <td>
                        <span data-bind="text: email"></span>
                    </td>
                    <td>
                        <span data-bind="text: name"></span>
                    </td>
                    <td class="row fit">
                        <span class="col-sm-6" data-bind="text: validated"></span>
                        <div class="col-sm-6">
                            <a class='btn btn-primary text-right' data-toggle="tooltip" title="Resend invitation (or administrative password reset)" data-bind="click: $parent.resendInvite">
                                <span class="glyphicon glyphicon-open-file"></span>
                            </a>
                        </div>
                    </td>
                    <td>
                        <div class="btn-group" role="group" aria-label="Update user permissions">
                            <button type="button" data-bind="click: $parent.updatePerms.bind($data, 0), attr: {'class': perm0}">Normal</button>
                            <button type="button" data-bind="click: $parent.updatePerms.bind($data, 1), attr: {'class': perm1}">Delete</button>
                            <button type="button" data-bind="click: $parent.updatePerms.bind($data, 2), attr: {'class': perm2}">Superuser</button>
                        </div>
                        
                    </td>
                    <td class="fit">
                        <a class='btn btn-default' data-bind="click: $parent.delUser">
                            <span class="glyphicon glyphicon-trash"></span>
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>

    </div>

</div>
{{/inline}} 

{{#*inline "modal-block"}} 
{{!--{{> adminHelp}}--}} 
{{/inline}} 

{{#*inline "footer-block"}} 
{{#if updated}}<p>Database updated: {{updated}} | Records: {{numRecords}} | Latest: {{latest}}.</p>{{/if}} 

{{> footerBasic}}

<a href="#" style="cursor: pointer" data-toggle="modal" data-target="#adminHelp">Help</a>! 
{{/inline}} 

{{#*inline "scripts-block"}}
<script src="private/usertools.js"></script> 
{{/inline}} 
{{/layout}}